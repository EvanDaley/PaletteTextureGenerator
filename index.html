<!DOCTYPE html>
<html lang="en">
<head>
    <script src="https://cdn.tailwindcss.com"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Color Palette</title>
    <style>
        body {
            margin: 0;
            display: flex;
            flex-direction: column;
            height: 100vh;
        }
        .content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); /* Adjust column count dynamically */
            gap: 0; /* Remove margins between items */
            padding: 0; /* Remove padding */
            flex: 1;
        }
        .color-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border: 1px solid #ddd;
            border-radius: 0; /* Remove rounding to make edges flush */
            overflow: hidden;
        }

        .color {
            flex: 1;
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: Arial, sans-serif;
            color: white;
            font-size: 1.2em;
            text-shadow: 1px 1px 2px black;
        }
        .color:nth-child(odd) {
            color: black;
            text-shadow: 1px 1px 2px white;
        }
        input {
            margin: 10px 0;
        }
    </style>
</head>
<body>
</body>
<script>
    let colors = ["#587c57", "#332c28", "#dfc08b", "#1e90ff", "#ff6347", "#6a5acd"]; // Start with 6 colors

    const updateGradient = (color, gradientBox) => {
        const adjustColor = (color, amount) => {
            const usePound = color[0] === "#";
            const num = parseInt(color.slice(1), 16);

            let r = (num >> 16) + amount;
            let g = ((num >> 8) & 0x00ff) + amount;
            let b = (num & 0x0000ff) + amount;

            r = Math.max(Math.min(255, r), 0);
            g = Math.max(Math.min(255, g), 0);
            b = Math.max(Math.min(255, b), 0);

            return (usePound ? "#" : "") + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1).toUpperCase();
        };

        const lighterColor = adjustColor(color, 40);
        const darkerColor = adjustColor(color, -80);

        gradientBox.style.background = `linear-gradient(to top, ${darkerColor}, ${color} 50%, ${lighterColor})`;
    };

    const adjustGridLayout = () => {
        const contentDiv = document.querySelector('.content');
        const totalColors = colors.length;
        const columns = Math.ceil(Math.sqrt(totalColors)); // Number of columns
        const rows = Math.ceil(totalColors / columns); // Number of rows

        contentDiv.style.gridTemplateColumns = `repeat(${columns}, 1fr)`;
    };

    const initializeInputAndGradient = (index) => {
        const container = document.createElement('div');
        container.classList.add('color-container');

        const input = document.createElement('input');
        input.id = `input-${index}`;
        input.type = 'color';
        input.value = colors[index - 1]; // Use array value
        container.appendChild(input);

        const gradientBox = document.createElement('div');
        gradientBox.id = `gradient-${index}`;
        gradientBox.classList.add('color');
        container.appendChild(gradientBox);

        // Append to the content container
        document.querySelector('.content').appendChild(container);

        // Initialize gradient
        updateGradient(colors[index - 1], gradientBox);

        // Attach event listener
        input.addEventListener('input', () => {
            colors[index - 1] = input.value; // Update array
            updateGradient(colors[index - 1], gradientBox);
        });
    };

    const initializeGradients = () => {
        for (let i = 1; i <= colors.length; i++) {
            initializeInputAndGradient(i);
        }
        adjustGridLayout(); // Ensure grid adjusts to the initial number of colors
    };

    const addNewColor = (color = "#ffffff") => {
        colors.push(color); // Add new color to the array
        const index = colors.length; // New index
        initializeInputAndGradient(index); // Initialize new input and gradient
        adjustGridLayout(); // Adjust the grid layout
    };


    window.addEventListener('DOMContentLoaded', () => {
        // Create a container div for the tools section
        const toolsDiv = document.createElement('div');
        toolsDiv.className = "w-full bg-gray-100 border-b shadow-md mb-2"; // Remove padding and rounded edges

        // toolsDiv.className = "mx-auto p-4 bg-gray-100 border-b rounded-b shadow-md w-full";
        toolsDiv.style.maxWidth = "800px";

        // Add a header
        const header = document.createElement('h3');
        header.textContent = "Actions";
        header.className = "text-lg font-bold text-gray-700 mb-3";
        toolsDiv.appendChild(header);

        // Add a button for adding new colors
        const addButton = document.createElement('button');
        addButton.textContent = "Add Color";
        addButton.className = "w-full bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded";
        addButton.addEventListener('click', () => addNewColor());
        toolsDiv.appendChild(addButton);

        // Append the tools div to the top of the body
        document.body.appendChild(toolsDiv);

        // Create the content container
        const contentDiv = document.createElement('div');
        contentDiv.className = "content";
        document.body.appendChild(contentDiv);

        initializeGradients();
    });
</script>
</html>
